// 1.1.0
(()=>{"use strict";var e={93:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PBJS_VALUE_LAST=t.PBJS_VALUE_EXP=t.PBJS_VALUE_KEY=t.GLOBO_USER_INFO=t.GLB_TIPO_LOGADO=t.ENVELOPE_TTL_MS=t.ENVELOPE_KEY=t.ENVELOPE_EXPIRE_KEY=t.ATS_REGULAR_ENVELOPE_TYPE=t.ATS_REFRESH_URL_BASE=t.ATS_PLACEMENT_ID=t.ATS_HASHED_EMAIL_TYPE=t.ATS_CACHE_KEY=t.ATS_API_BASE_URL=void 0,t.ATS_API_BASE_URL="https://api.rlcdn.com/api/identity/envelope",t.ATS_CACHE_KEY="ats_envelope_identifier",t.ATS_HASHED_EMAIL_TYPE=4,t.ATS_PLACEMENT_ID="13715",t.ATS_REFRESH_URL_BASE=t.ATS_API_BASE_URL+"/refresh",t.ATS_REGULAR_ENVELOPE_TYPE=19,t.ENVELOPE_EXPIRE_KEY="_lr_env_exp",t.ENVELOPE_KEY="_lr_env",t.ENVELOPE_TTL_MS=18e5,t.GLB_TIPO_LOGADO="logado",t.GLOBO_USER_INFO="globo_user_info",t.PBJS_VALUE_KEY="idl_env",t.PBJS_VALUE_EXP="idl_env_exp",t.PBJS_VALUE_LAST="idl_env_last"},50:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getUserInfoCadun=void 0,window.cq=window.cq||[],t.getUserInfoCadun=function(){return n(this,void 0,void 0,(function*(){return new Promise((function(e){window.cq.push({ready:()=>{window.Cadun.Event.subscribe("userInfoAvailable",(t=>{e(t)}))}})}))}))}},39:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor({identityBaseUrl:e,identityType:t,placementId:n,refreshBaseUrl:r,refreshType:o}){this.identityBaseUrl=e,this.identityType=t,this.placementId=n,this.refreshBaseUrl=r,this.refreshType=o}retrieveEnvelope(e){return n(this,void 0,void 0,(function*(){try{return yield this.fetchUrl(this.getIdentityUrl(e).toString())}catch(e){throw new Error(`Error when retrieve envelope: ${e.message}`)}}))}refreshEnvelope(e){return n(this,void 0,void 0,(function*(){try{return yield this.fetchUrl(this.getRefreshUrl(e.envelope).toString())}catch(e){throw new Error(`Error when refresh envelope: ${e.message}`)}}))}fetchUrl(e){return n(this,void 0,void 0,(function*(){const t=yield fetch(e);if(!t.ok)throw new Error("Error while performing request");return yield t.json()}))}getIdentityUrl(e){return this.generateAtsUrl(this.identityBaseUrl,this.identityType,this.placementId,e)}getRefreshUrl(e){return this.generateAtsUrl(this.refreshBaseUrl,this.refreshType,this.placementId,e)}generateAtsUrl(e,t,n,r){const o=new URL(e);return o.searchParams.set("iv",r),o.searchParams.set("pid",n),o.searchParams.set("it",t.toString()),o}}},475:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{enqueue(e){window.pbjs=window.pbjs||{que:[]},window.pbjs.que.push(e)}refreshUserIds(){this.enqueue((()=>{window.pbjs.refreshUserIds()}))}}},519:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(93),i=r(n(39)),l=r(n(475)),a=n(343),s=n(975),c=n(414);(()=>{const e=new i.default({identityBaseUrl:o.ATS_API_BASE_URL,refreshBaseUrl:o.ATS_REFRESH_URL_BASE,identityType:o.ATS_HASHED_EMAIL_TYPE,refreshType:o.ATS_REGULAR_ENVELOPE_TYPE,placementId:o.ATS_PLACEMENT_ID}),t=new l.default,n=(0,s.getGlbId)();n?(0,a.loadAts)(e,t,n):(0,c.clearAll)()})()},343:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.loadAts=void 0;const o=n(562),i=n(414),l=n(354),a=n(50);t.loadAts=function(e,t,n){return r(this,void 0,void 0,(function*(){try{let r=(0,i.getLocalEnvelope)();if((0,o.isAuthorizedUser)(n)&&(0,i.envelopeValid)(r))(0,i.envelopeExpired)()&&(r=yield e.refreshEnvelope(r),(0,i.storeEnvelope)(r));else{(0,i.clearAll)(),(0,o.setGlbId)(n);let t=(0,o.getLocalUserEmail)();t||(t=(yield(0,a.getUserInfoCadun)()).email);const s=yield(0,l.hashEmail)(t);r=yield e.retrieveEnvelope(s),(0,i.storeEnvelope)(r)}t.refreshUserIds()}catch(e){(0,i.clearAll)()}}))}},603:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCookie=void 0,t.getCookie=function(e){const t=document.cookie.match(new RegExp(`${e}=([^;]+)`));return t?t[1]:null}},354:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.hashEmail=void 0,t.hashEmail=function(e){return n(this,void 0,void 0,(function*(){const t=(new TextEncoder).encode(e),n=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}))}},414:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function l(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setAtsGlbCache=t.retrieveAtsGlbCache=t.getUserHashedEmail=t.envelopeExpired=t.envelopeValid=t.getLocalEnvelope=t.storeEnvelope=t.clearAll=void 0;const o=n(93),i=n(50),l=n(354);function a(){return(new Date).getTime()}t.clearAll=function(){localStorage.removeItem(o.ATS_CACHE_KEY),localStorage.removeItem(o.ENVELOPE_EXPIRE_KEY),localStorage.removeItem(o.ENVELOPE_KEY),localStorage.removeItem(o.PBJS_VALUE_EXP),localStorage.removeItem(o.PBJS_VALUE_KEY),localStorage.removeItem(o.PBJS_VALUE_LAST)},t.storeEnvelope=function(e){localStorage.setItem(o.ENVELOPE_KEY,window.btoa(JSON.stringify(e))),localStorage.setItem(o.PBJS_VALUE_KEY,e.envelope),function(){const e=a()+o.ENVELOPE_TTL_MS;localStorage.setItem(o.ENVELOPE_EXPIRE_KEY,String(e)),localStorage.setItem(o.PBJS_VALUE_LAST,(new Date).toUTCString()),localStorage.setItem(o.PBJS_VALUE_EXP,new Date(e).toUTCString())}()},t.getLocalEnvelope=function(){const e=localStorage.getItem(o.ENVELOPE_KEY);return e?JSON.parse(window.atob(e)):null},t.envelopeValid=function(e){return Boolean(e&&e.hasOwnProperty("envelope"))},t.envelopeExpired=function(){const e=localStorage.getItem(o.ENVELOPE_EXPIRE_KEY);if(!e)return!0;const t=parseInt(e);return isNaN(t)||a()>t},t.getUserHashedEmail=function(){return r(this,void 0,void 0,(function*(){const e=yield(0,i.getUserInfoCadun)();return yield(0,l.hashEmail)(e.email)}))},t.retrieveAtsGlbCache=function(){return localStorage.getItem(o.ATS_CACHE_KEY)||null},t.setAtsGlbCache=function(e){localStorage.setItem(o.ATS_CACHE_KEY,e)}},975:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGlbId=void 0;const r=n(603),o=n(913);t.getGlbId=function(){try{const e=(0,r.getCookie)("GLOBO_ID");return e?(0,o.retrievePayload)(e).globoId:null}catch(e){return null}}},913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrievePayload=void 0,t.retrievePayload=function(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((e=>`%${("00"+e.charCodeAt(0).toString(16)).slice(-2)}`)).join(""));return JSON.parse(n)}},562:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalUserEmail=t.setGlbId=t.isAuthorizedUser=void 0;const r=n(414),o=n(93);t.isAuthorizedUser=function(e){return(0,r.retrieveAtsGlbCache)()===e},t.setGlbId=function(e){(0,r.clearAll)(),(0,r.setAtsGlbCache)(e)},t.getLocalUserEmail=function(){const e=localStorage.getItem(o.GLOBO_USER_INFO);return e?JSON.parse(e).email:null}}},t={};!function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(519)})();